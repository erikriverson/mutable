An Introduction to the **mutable** Package
========================================================

We have all been there. 

Your data has been collected, cleaned, and analyzed.  You have the
results of a regression model or want to compare groups in a
randomized study. All you want to do is create a basic table that you
can quickly share with colleagues, students, or clients. It would be
nice if you could define how the table looked with minimal time and
effort. Oh yeah, and it should look good.

Enter mutable. 

Inspired heavily by xtable and Hmisc's summary.formula, the mutable
package (https://github.com/erikriverson/mutable) provides a flexible
method for generating markup tables from the R programming
language. It allows users to construct objects of arbitrary tabular
material such as data.frames, matrices, coefficient tables, and
summaries of multiple variables. You can then output the object into a
variety of formats. LaTeX, HTML, and plain text output functions are
included by default.

But you don't have to trust that the author gave you the best way to
represent a table in each markup language. You can supply your own
formatting functions for all of these types. For example, the provided
HTML output style for factors (percentages and fractions) can be
completely changed if you specify your ownown muExportHTML
function. The modular design of the package allows every markup
decision to be overridden easily and consistently. The result is that
the user is in complete control over the final markup produced, and
that multiple versions of the same table can easily be produced from
the same data simultaneously.

Sound interesting? Let's walk through the basics! 

First thing is first, let's install the package. It currently relies
on a couple of other packages (Hmisc and RJSONIO). We also need to
install devtools so that you can install the latest version of mutable
from its Github repository. The following lines take care of all this
housekeeping. 

```{r}
 library(devtools)
 install_github("mutable", "erikriverson")
 library(mutable)
 library(Hmisc)
 library(RJSONIO)
```

Mutable can create markup tables from common R objects. For example, a
data.frame. Simply call the **mutable** function on any data.frame,
let's use the **mtcars** data.frame in this example. 

```{r}
m1 <- mutable(mtcars)
```

By default, mutable has created an object that contains markup for
plain text, HTML, and LaTeX using its default markup functions! 


```{r}
summary(m1)
```

Since I am writing this demo using Markdown and using knitr to process
it to HTML, I want to simply extract the HTML

```{r, results="asis"}
html(m1)
```

Well that's about as basic an HTML table as you can get. But behind
the scenes, mutable has generated not only the HTML markup to get you that table, but assigned eachrow and column its own CSS ID for you to customize. 

Let's look at something a little more complex, summarizing multiple
variables with columns for each value of a stratification
variable. First, let's add variable labels to a different built-in
data.frame.

```{r}
data(airquality)
label(airquality$Ozone)   <- 'Ozone (ppb)'
label(airquality$Solar.R) <- 'Solar R (lang)'
label(airquality$Wind)    <- 'Wind (mph)'
label(airquality$Temp)    <- 'Temperature (degrees F)'
airquality$Month <- factor(airquality$Month, labels = month.abb[5:9])
```
Now, use mutable's formula interface to create a summary table. 

```{r}
m2 <- mutable(Month ~ Ozone + Solar.R + Wind + Temp, data = airquality)
```

And view the HTML. 

```{r, results = "asis"}
html(m2) 
``` 

Want MathJax? 
```{r, results = "asis"}
m2 <- mutable(Month ~ Ozone + Solar.R + Wind + Temp, data = airquality,
              markup.functions = list(html = muExportHTMLMathJax))
html(m2)
```


html(m2,
     documentHeaderFunction = muSlickGridDocHeader,
     headerFunction = muSlickGridHeader,
     markupFunction = muSlickGridMarkupGenerator,
     footerFunction = muSlickGridFooter,
     documentFooterFunction = muSlickGridDocFooter,
     completeDocument = TRUE,
     markupElement = "plain",
     file = "/work/eiverson/projects/src/SlickGrid/examples/mut1.html")



